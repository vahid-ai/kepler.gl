"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

var _interopRequireWildcard = require("@babel/runtime/helpers/interopRequireWildcard");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports["default"] = TimeRangeSliderFactory;

var _taggedTemplateLiteral2 = _interopRequireDefault(require("@babel/runtime/helpers/taggedTemplateLiteral"));

var _react = _interopRequireWildcard(require("react"));

var _lodash = _interopRequireDefault(require("lodash.throttle"));

var _styledComponents = _interopRequireDefault(require("styled-components"));

var _rangeSlider = _interopRequireDefault(require("./range-slider"));

var _timeSliderMarker = _interopRequireDefault(require("./time-slider-marker"));

var _playbackControls = _interopRequireDefault(require("./animation-control/playback-controls"));

var _timeRangeSliderTimeTitle = _interopRequireDefault(require("./time-range-slider-time-title"));

var _animationControl = _interopRequireDefault(require("./animation-control/animation-control"));

var _templateObject;

var animationControlWidth = 176;

var StyledSliderContainer = _styledComponents["default"].div(_templateObject || (_templateObject = (0, _taggedTemplateLiteral2["default"])(["\n  align-items: flex-end;\n  display: flex;\n  flex-direction: row;\n  justify-content: space-between;\n  padding-left: ", "px;\n\n  .timeline-container .kg-slider {\n    display: none;\n  }\n\n  .playback-controls {\n    margin-left: 22px;\n  }\n"])), function (props) {
  return props.isEnlarged ? 24 : 0;
});

var ANIMATION_CONTROL_STYLE = {
  flex: 1
};
TimeRangeSliderFactory.deps = [_playbackControls["default"], _rangeSlider["default"], _timeSliderMarker["default"], _timeRangeSliderTimeTitle["default"], _animationControl["default"]];

function TimeRangeSliderFactory(PlaybackControls, RangeSlider, TimeSliderMarker, TimeRangeSliderTimeTitle, AnimationControl) {
  var TimeRangeSlider = function TimeRangeSlider(props) {
    var domain = props.domain,
        value = props.value,
        isEnlarged = props.isEnlarged,
        isMinified = props.isMinified,
        hideTimeTitle = props.hideTimeTitle,
        isAnimating = props.isAnimating,
        resetAnimation = props.resetAnimation,
        timeFormat = props.timeFormat,
        timezone = props.timezone,
        histogram = props.histogram,
        plotType = props.plotType,
        lineChart = props.lineChart,
        step = props.step,
        isAnimatable = props.isAnimatable,
        speed = props.speed,
        animationWindow = props.animationWindow,
        updateAnimationSpeed = props.updateAnimationSpeed,
        setFilterAnimationWindow = props.setFilterAnimationWindow,
        toggleAnimation = props.toggleAnimation,
        onChange = props.onChange,
        timeline = props.timeline;
    var throttledOnchange = (0, _react.useMemo)(function () {
      return (0, _lodash["default"])(onChange, 20);
    }, [onChange]);
    var style = (0, _react.useMemo)(function () {
      return {
        width: isEnlarged ? "calc(100% - ".concat(animationControlWidth, "px)") : '100%'
      };
    }, [isEnlarged]);
    return /*#__PURE__*/_react["default"].createElement("div", {
      className: "time-range-slider"
    }, !hideTimeTitle && isEnlarged ? /*#__PURE__*/_react["default"].createElement("div", {
      className: "time-range-slider__title",
      style: style
    }, /*#__PURE__*/_react["default"].createElement(TimeRangeSliderTimeTitle, {
      timeFormat: timeFormat,
      timezone: timezone,
      value: value,
      isEnlarged: isEnlarged
    })) : null, /*#__PURE__*/_react["default"].createElement(StyledSliderContainer, {
      className: "time-range-slider__container",
      isEnlarged: isEnlarged
    }, !isMinified ? /*#__PURE__*/_react["default"].createElement("div", {
      className: "timeline-container",
      style: style
    }, /*#__PURE__*/_react["default"].createElement(RangeSlider, {
      range: domain,
      value0: value[0],
      value1: value[1],
      histogram: histogram,
      lineChart: lineChart,
      plotType: plotType,
      isEnlarged: isEnlarged,
      showInput: false,
      step: step,
      onChange: throttledOnchange,
      xAxis: TimeSliderMarker,
      timezone: timezone,
      timeFormat: timeFormat
    })) : /*#__PURE__*/_react["default"].createElement(AnimationControl, {
      style: ANIMATION_CONTROL_STYLE,
      isAnimatable: isAnimatable,
      isAnimating: isAnimating,
      resetAnimation: resetAnimation,
      toggleAnimation: toggleAnimation,
      updateAnimationSpeed: updateAnimationSpeed,
      setTimelineValue: throttledOnchange,
      setAnimationWindow: setFilterAnimationWindow,
      showTimeDisplay: false,
      timeline: timeline
    }), isEnlarged && !isMinified ? /*#__PURE__*/_react["default"].createElement(PlaybackControls, {
      isAnimatable: isAnimatable,
      width: animationControlWidth,
      speed: speed,
      animationWindow: animationWindow,
      updateAnimationSpeed: updateAnimationSpeed,
      setFilterAnimationWindow: setFilterAnimationWindow,
      pauseAnimation: toggleAnimation,
      resetAnimation: resetAnimation,
      isAnimating: isAnimating,
      startAnimation: toggleAnimation
    }) : null));
  };

  return /*#__PURE__*/_react["default"].memo(TimeRangeSlider);
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NyYy9jb21wb25lbnRzL3NyYy9jb21tb24vdGltZS1yYW5nZS1zbGlkZXIudHN4Il0sIm5hbWVzIjpbImFuaW1hdGlvbkNvbnRyb2xXaWR0aCIsIlN0eWxlZFNsaWRlckNvbnRhaW5lciIsInN0eWxlZCIsImRpdiIsInByb3BzIiwiaXNFbmxhcmdlZCIsIkFOSU1BVElPTl9DT05UUk9MX1NUWUxFIiwiZmxleCIsIlRpbWVSYW5nZVNsaWRlckZhY3RvcnkiLCJkZXBzIiwiUGxheWJhY2tDb250cm9sc0ZhY3RvcnkiLCJSYW5nZVNsaWRlckZhY3RvcnkiLCJUaW1lU2xpZGVyTWFya2VyRmFjdG9yeSIsIlRpbWVSYW5nZVNsaWRlclRpbWVUaXRsZUZhY3RvcnkiLCJBbmltYXRpb25Db250cm9sRmFjdG9yeSIsIlBsYXliYWNrQ29udHJvbHMiLCJSYW5nZVNsaWRlciIsIlRpbWVTbGlkZXJNYXJrZXIiLCJUaW1lUmFuZ2VTbGlkZXJUaW1lVGl0bGUiLCJBbmltYXRpb25Db250cm9sIiwiVGltZVJhbmdlU2xpZGVyIiwiZG9tYWluIiwidmFsdWUiLCJpc01pbmlmaWVkIiwiaGlkZVRpbWVUaXRsZSIsImlzQW5pbWF0aW5nIiwicmVzZXRBbmltYXRpb24iLCJ0aW1lRm9ybWF0IiwidGltZXpvbmUiLCJoaXN0b2dyYW0iLCJwbG90VHlwZSIsImxpbmVDaGFydCIsInN0ZXAiLCJpc0FuaW1hdGFibGUiLCJzcGVlZCIsImFuaW1hdGlvbldpbmRvdyIsInVwZGF0ZUFuaW1hdGlvblNwZWVkIiwic2V0RmlsdGVyQW5pbWF0aW9uV2luZG93IiwidG9nZ2xlQW5pbWF0aW9uIiwib25DaGFuZ2UiLCJ0aW1lbGluZSIsInRocm90dGxlZE9uY2hhbmdlIiwic3R5bGUiLCJ3aWR0aCIsIlJlYWN0IiwibWVtbyJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7OztBQW9CQTs7QUFDQTs7QUFDQTs7QUFFQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFFQTs7OztBQUVBLElB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TG5CO0FBTUUsTUFBQSxvQkFBb0IsRUFBRUYsb0JBTnhCO0FBT0UsTUFBQSxnQkFBZ0IsRUFBRUssaUJBUHBCO0FBUUUsTUFBQSxrQkFBa0IsRUFBRUosd0JBUnRCO0FBU0UsTUFBQSxlQUFlLEVBQUUsS0FUbkI7QUFVRSxNQUFBLFFBQVEsRUFBRUc7QUFWWixNQXBCSixFQWlDR25DLFVBQVUsSUFBSSxDQUFDa0IsVUFBZixnQkFDQyxnQ0FBQyxnQkFBRDtBQUNFLE1BQUEsWUFBWSxFQUFFVSxZQURoQjtBQUVFLE1BQUEsS0FBSyxFQUFFakMscUJBRlQ7QUFHRSxNQUFBLEtBQUssRUFBRWtDLEtBSFQ7QUFJRSxNQUFBLGVBQWUsRUFBRUMsZUFKbkI7QUFLRSxNQUFBLG9CQUFvQixFQUFFQyxvQkFMeEI7QUFNRSxNQUFBLHdCQUF3QixFQUFFQyx3QkFONUI7QUFPRSxNQUFBLGNBQWMsRUFBRUMsZUFQbEI7QUFRRSxNQUFBLGNBQWMsRUFBRVosY0FSbEI7QUFTRSxNQUFBLFdBQVcsRUFBRUQsV0FUZjtBQVVFLE1BQUEsY0FBYyxFQUFFYTtBQVZsQixNQURELEdBYUcsSUE5Q04sQ0FYRixDQURGO0FBOERELEdBaEdEOztBQWtHQSxzQkFBT00sa0JBQU1DLElBQU4sQ0FBV3pCLGVBQVgsQ0FBUDtBQUNEIiwic291cmNlc0NvbnRlbnQiOlsiLy8gQ29weXJpZ2h0IChjKSAyMDIzIFViZXIgVGVjaG5vbG9naWVzLCBJbmMuXG4vL1xuLy8gUGVybWlzc2lvbiBpcyBoZXJlYnkgZ3JhbnRlZCwgZnJlZSBvZiBjaGFyZ2UsIHRvIGFueSBwZXJzb24gb2J0YWluaW5nIGEgY29weVxuLy8gb2YgdGhpcyBzb2Z0d2FyZSBhbmQgYXNzb2NpYXRlZCBkb2N1bWVudGF0aW9uIGZpbGVzICh0aGUgXCJTb2Z0d2FyZVwiKSwgdG8gZGVhbFxuLy8gaW4gdGhlIFNvZnR3YXJlIHdpdGhvdXQgcmVzdHJpY3Rpb24sIGluY2x1ZGluZyB3aXRob3V0IGxpbWl0YXRpb24gdGhlIHJpZ2h0c1xuLy8gdG8gdXNlLCBjb3B5LCBtb2RpZnksIG1lcmdlLCBwdWJsaXNoLCBkaXN0cmlidXRlLCBzdWJsaWNlbnNlLCBhbmQvb3Igc2VsbFxuLy8gY29waWVzIG9mIHRoZSBTb2Z0d2FyZSwgYW5kIHRvIHBlcm1pdCBwZXJzb25zIHRvIHdob20gdGhlIFNvZnR3YXJlIGlzXG4vLyBmdXJuaXNoZWQgdG8gZG8gc28sIHN1YmplY3QgdG8gdGhlIGZvbGxvd2luZyBjb25kaXRpb25zOlxuLy9cbi8vIFRoZSBhYm92ZSBjb3B5cmlnaHQgbm90aWNlIGFuZCB0aGlzIHBlcm1pc3Npb24gbm90aWNlIHNoYWxsIGJlIGluY2x1ZGVkIGluXG4vLyBhbGwgY29waWVzIG9yIHN1YnN0YW50aWFsIHBvcnRpb25zIG9mIHRoZSBTb2Z0d2FyZS5cbi8vXG4vLyBUSEUgU09GVFdBUkUgSVMgUFJPVklERUQgXCJBUyBJU1wiLCBXSVRIT1VUIFdBUlJBTlRZIE9GIEFOWSBLSU5ELCBFWFBSRVNTIE9SXG4vLyBJTVBMSUVELCBJTkNMVURJTkcgQlVUIE5PVCBMSU1JVEVEIFRPIFRIRSBXQVJSQU5USUVTIE9GIE1FUkNIQU5UQUJJTElUWSxcbi8vIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFIEFORCBOT05JTkZSSU5HRU1FTlQuIElOIE5PIEVWRU5UIFNIQUxMIFRIRVxuLy8gQVVUSE9SUyBPUiBDT1BZUklHSFQgSE9MREVSUyBCRSBMSUFCTEUgRk9SIEFOWSBDTEFJTSwgREFNQUdFUyBPUiBPVEhFUlxuLy8gTElBQklMSVRZLCBXSEVUSEVSIElOIEFOIEFDVElPTiBPRiBDT05UUkFDVCwgVE9SVCBPUiBPVEhFUldJU0UsIEFSSVNJTkcgRlJPTSxcbi8vIE9VVCBPRiBPUiBJTiBDT05ORUNUSU9OIFdJVEggVEhFIFNPRlRXQVJFIE9SIFRIRSBVU0UgT1IgT1RIRVIgREVBTElOR1MgSU5cbi8vIFRIRSBTT0ZUV0FSRS5cblxuaW1wb3J0IFJlYWN0LCB7dXNlTWVtb30gZnJvbSAncmVhY3QnO1xuaW1wb3J0IHRocm90dGxlIGZyb20gJ2xvZGFzaC50aHJvdHRsZSc7XG5pbXBvcnQgc3R5bGVkIGZyb20gJ3N0eWxlZC1jb21wb25lbnRzJztcblxuaW1wb3J0IFJhbmdlU2xpZGVyRmFjdG9yeSBmcm9tICcuL3JhbmdlLXNsaWRlcic7XG5pbXBvcnQgVGltZVNsaWRlck1hcmtlckZhY3RvcnkgZnJvbSAnLi90aW1lLXNsaWRlci1tYXJrZXInO1xuaW1wb3J0IFBsYXliYWNrQ29udHJvbHNGYWN0b3J5IGZyb20gJy4vYW5pbWF0aW9uLWNvbnRyb2wvcGxheWJhY2stY29udHJvbHMnO1xuaW1wb3J0IFRpbWVSYW5nZVNsaWRlclRpbWVUaXRsZUZhY3RvcnkgZnJvbSAnLi90aW1lLXJhbmdlLXNsaWRlci10aW1lLXRpdGxlJztcbmltcG9ydCB7SGlzdG9ncmFtQmluLCBMaW5lQ2hhcnQsIFRpbWVsaW5lfSBmcm9tICdAa2VwbGVyLmdsL3R5cGVzJztcbmltcG9ydCBBbmltYXRpb25Db250cm9sRmFjdG9yeSBmcm9tICcuL2FuaW1hdGlvbi1jb250cm9sL2FuaW1hdGlvbi1jb250cm9sJztcblxuY29uc3QgYW5pbWF0aW9uQ29udHJvbFdpZHRoID0gMTc2O1xuXG5pbnRlcmZhY2UgU3R5bGVkU2xpZGVyQ29udGFpbmVyUHJvcHMge1xuICBpc0VubGFyZ2VkPzogYm9vbGVhbjtcbn1cblxudHlwZSBUaW1lUmFuZ2VTbGlkZXJQcm9wcyA9IHtcbiAgZG9tYWluPzogW251bWJlciwgbnVtYmVyXTtcbiAgdmFsdWU6IFtudW1iZXIsIG51bWJlcl07XG4gIGlzRW5sYXJnZWQ/OiBib29sZWFuO1xuICBpc01pbmlmaWVkPzogYm9vbGVhbjtcbiAgaGlkZVRpbWVUaXRsZT86IGJvb2xlYW47XG4gIGlzQW5pbWF0aW5nOiBib29sZWFuO1xuICB0aW1lRm9ybWF0OiBzdHJpbmc7XG4gIHRpbWV6b25lPzogc3RyaW5nIHwgbnVsbDtcbiAgaGlzdG9ncmFtPzogSGlzdG9ncmFtQmluW107XG4gIHBsb3RUeXBlPzogc3RyaW5nO1xuICBsaW5lQ2hhcnQ/OiBMaW5lQ2hhcnQ7XG4gIHN0ZXA6IG51bWJlcjtcbiAgaXNBbmltYXRhYmxlPzogYm9vbGVhbjtcbiAgc3BlZWQ6IG51bWJlcjtcbiAgYW5pbWF0aW9uV2luZG93OiBzdHJpbmc7XG4gIHJlc2V0QW5pbWF0aW9uPzogKCkgPT4gdm9pZDtcbiAgdG9nZ2xlQW5pbWF0aW9uOiAoKSA9PiB2b2lkO1xuICB1cGRhdGVBbmltYXRpb25TcGVlZD86ICh2YWw6IG51bWJlcikgPT4gdm9pZDtcbiAgc2V0RmlsdGVyQW5pbWF0aW9uV2luZG93PzogKGlkOiBzdHJpbmcpID0+IHZvaWQ7XG4gIG9uQ2hhbmdlOiAodjogbnVtYmVyW10pID0+IHZvaWQ7XG4gIHRpbWVsaW5lOiBUaW1lbGluZTtcbn07XG5cbmNvbnN0IFN0eWxlZFNsaWRlckNvbnRhaW5lciA9IHN0eWxlZC5kaXY8U3R5bGVkU2xpZGVyQ29udGFpbmVyUHJvcHM+YFxuICBhbGlnbi1pdGVtczogZmxleC1lbmQ7XG4gIGRpc3BsYXk6IGZsZXg7XG4gIGZsZXgtZGlyZWN0aW9uOiByb3c7XG4gIGp1c3RpZnktY29udGVudDogc3BhY2UtYmV0d2VlbjtcbiAgcGFkZGluZy1sZWZ0OiAke3Byb3BzID0+IChwcm9wcy5pc0VubGFyZ2VkID8gMjQgOiAwKX1weDtcblxuICAudGltZWxpbmUtY29udGFpbmVyIC5rZy1zbGlkZXIge1xuICAgIGRpc3BsYXk6IG5vbmU7XG4gIH1cblxuICAucGxheWJhY2stY29udHJvbHMge1xuICAgIG1hcmdpbi1sZWZ0OiAyMnB4O1xuICB9XG5gO1xuXG5jb25zdCBBTklNQVRJT05fQ09OVFJPTF9TVFlMRSA9IHtmbGV4OiAxfTtcblxuVGltZVJhbmdlU2xpZGVyRmFjdG9yeS5kZXBzID0gW1xuICBQbGF5YmFja0NvbnRyb2xzRmFjdG9yeSxcbiAgUmFuZ2VTbGlkZXJGYWN0b3J5LFxuICBUaW1lU2xpZGVyTWFya2VyRmFjdG9yeSxcbiAgVGltZVJhbmdlU2xpZGVyVGltZVRpdGxlRmFjdG9yeSxcbiAgQW5pbWF0aW9uQ29udHJvbEZhY3Rvcnlcbl07XG5cbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIFRpbWVSYW5nZVNsaWRlckZhY3RvcnkoXG4gIFBsYXliYWNrQ29udHJvbHM6IFJldHVyblR5cGU8dHlwZW9mIFBsYXliYWNrQ29udHJvbHNGYWN0b3J5PixcbiAgUmFuZ2VTbGlkZXI6IFJldHVyblR5cGU8dHlwZW9mIFJhbmdlU2xpZGVyRmFjdG9yeT4sXG4gIFRpbWVTbGlkZXJNYXJrZXI6IFJldHVyblR5cGU8dHlwZW9mIFRpbWVTbGlkZXJNYXJrZXJGYWN0b3J5PixcbiAgVGltZVJhbmdlU2xpZGVyVGltZVRpdGxlOiBSZXR1cm5UeXBlPHR5cGVvZiBUaW1lUmFuZ2VTbGlkZXJUaW1lVGl0bGVGYWN0b3J5PixcbiAgQW5pbWF0aW9uQ29udHJvbDogUmV0dXJuVHlwZTx0eXBlb2YgQW5pbWF0aW9uQ29udHJvbEZhY3Rvcnk+XG4pIHtcbiAgY29uc3QgVGltZVJhbmdlU2xpZGVyOiBSZWFjdC5GQzxUaW1lUmFuZ2VTbGlkZXJQcm9wcz4gPSBwcm9wcyA9PiB7XG4gICAgY29uc3Qge1xuICAgICAgZG9tYWluLFxuICAgICAgdmFsdWUsXG4gICAgICBpc0VubGFyZ2VkLFxuICAgICAgaXNNaW5pZmllZCxcbiAgICAgIGhpZGVUaW1lVGl0bGUsXG4gICAgICBpc0FuaW1hdGluZyxcbiAgICAgIHJlc2V0QW5pbWF0aW9uLFxuICAgICAgdGltZUZvcm1hdCxcbiAgICAgIHRpbWV6b25lLFxuICAgICAgaGlzdG9ncmFtLFxuICAgICAgcGxvdFR5cGUsXG4gICAgICBsaW5lQ2hhcnQsXG4gICAgICBzdGVwLFxuICAgICAgaXNBbmltYXRhYmxlLFxuICAgICAgc3BlZWQsXG4gICAgICBhbmltYXRpb25XaW5kb3csXG4gICAgICB1cGRhdGVBbmltYXRpb25TcGVlZCxcbiAgICAgIHNldEZpbHRlckFuaW1hdGlvbldpbmRvdyxcbiAgICAgIHRvZ2dsZUFuaW1hdGlvbixcbiAgICAgIG9uQ2hhbmdlLFxuICAgICAgdGltZWxpbmVcbiAgICB9ID0gcHJvcHM7XG5cbiAgICBjb25zdCB0aHJvdHRsZWRPbmNoYW5nZSA9IHVzZU1lbW8oKCkgPT4gdGhyb3R0bGUob25DaGFuZ2UsIDIwKSwgW29uQ2hhbmdlXSk7XG5cbiAgICBjb25zdCBzdHlsZSA9IHVzZU1lbW8oXG4gICAgICAoKSA9PiAoe1xuICAgICAgICB3aWR0aDogaXNFbmxhcmdlZCA/IGBjYWxjKDEwMCUgLSAke2FuaW1hdGlvbkNvbnRyb2xXaWR0aH1weClgIDogJzEwMCUnXG4gICAgICB9KSxcbiAgICAgIFtpc0VubGFyZ2VkXVxuICAgICk7XG5cbiAgICByZXR1cm4gKFxuICAgICAgPGRpdiBjbGFzc05hbWU9XCJ0aW1lLXJhbmdlLXNsaWRlclwiPlxuICAgICAgICB7IWhpZGVUaW1lVGl0bGUgJiYgaXNFbmxhcmdlZCA/IChcbiAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cInRpbWUtcmFuZ2Utc2xpZGVyX190aXRsZVwiIHN0eWxlPXtzdHlsZX0+XG4gICAgICAgICAgICA8VGltZVJhbmdlU2xpZGVyVGltZVRpdGxlXG4gICAgICAgICAgICAgIHRpbWVGb3JtYXQ9e3RpbWVGb3JtYXR9XG4gICAgICAgICAgICAgIHRpbWV6b25lPXt0aW1lem9uZX1cbiAgICAgICAgICAgICAgdmFsdWU9e3ZhbHVlfVxuICAgICAgICAgICAgICBpc0VubGFyZ2VkPXtpc0VubGFyZ2VkfVxuICAgICAgICAgICAgLz5cbiAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgKSA6IG51bGx9XG4gICAgICAgIDxTdHlsZWRTbGlkZXJDb250YWluZXIgY2xhc3NOYW1lPVwidGltZS1yYW5nZS1zbGlkZXJfX2NvbnRhaW5lclwiIGlzRW5sYXJnZWQ9e2lzRW5sYXJnZWR9PlxuICAgICAgICAgIHshaXNNaW5pZmllZCA/IChcbiAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwidGltZWxpbmUtY29udGFpbmVyXCIgc3R5bGU9e3N0eWxlfT5cbiAgICAgICAgICAgICAgPFJhbmdlU2xpZGVyXG4gICAgICAgICAgICAgICAgcmFuZ2U9e2RvbWFpbn1cbiAgICAgICAgICAgICAgICB2YWx1ZTA9e3ZhbHVlWzBdfVxuICAgICAgICAgICAgICAgIHZhbHVlMT17dmFsdWVbMV19XG4gICAgICAgICAgICAgICAgaGlzdG9ncmFtPXtoaXN0b2dyYW19XG4gICAgICAgICAgICAgICAgbGluZUNoYXJ0PXtsaW5lQ2hhcnR9XG4gICAgICAgICAgICAgICAgcGxvdFR5cGU9e3Bsb3RUeXBlfVxuICAgICAgICAgICAgICAgIGlzRW5sYXJnZWQ9e2lzRW5sYXJnZWR9XG4gICAgICAgICAgICAgICAgc2hvd0lucHV0PXtmYWxzZX1cbiAgICAgICAgICAgICAgICBzdGVwPXtzdGVwfVxuICAgICAgICAgICAgICAgIG9uQ2hhbmdlPXt0aHJvdHRsZWRPbmNoYW5nZX1cbiAgICAgICAgICAgICAgICB4QXhpcz17VGltZVNsaWRlck1hcmtlcn1cbiAgICAgICAgICAgICAgICB0aW1lem9uZT17dGltZXpvbmV9XG4gICAgICAgICAgICAgICAgdGltZUZvcm1hdD17dGltZUZvcm1hdH1cbiAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICkgOiAoXG4gICAgICAgICAgICA8QW5pbWF0aW9uQ29udHJvbFxuICAgICAgICAgICAgICBzdHlsZT17QU5JTUFUSU9OX0NPTlRST0xfU1RZTEV9XG4gICAgICAgICAgICAgIGlzQW5pbWF0YWJsZT17aXNBbmltYXRhYmxlfVxuICAgICAgICAgICAgICBpc0FuaW1hdGluZz17aXNBbmltYXRpbmd9XG4gICAgICAgICAgICAgIHJlc2V0QW5pbWF0aW9uPXtyZXNldEFuaW1hdGlvbn1cbiAgICAgICAgICAgICAgdG9nZ2xlQW5pbWF0aW9uPXt0b2dnbGVBbmltYXRpb259XG4gICAgICAgICAgICAgIHVwZGF0ZUFuaW1hdGlvblNwZWVkPXt1cGRhdGVBbmltYXRpb25TcGVlZH1cbiAgICAgICAgICAgICAgc2V0VGltZWxpbmVWYWx1ZT17dGhyb3R0bGVkT25jaGFuZ2V9XG4gICAgICAgICAgICAgIHNldEFuaW1hdGlvbldpbmRvdz17c2V0RmlsdGVyQW5pbWF0aW9uV2luZG93fVxuICAgICAgICAgICAgICBzaG93VGltZURpc3BsYXk9e2ZhbHNlfVxuICAgICAgICAgICAgICB0aW1lbGluZT17dGltZWxpbmV9XG4gICAgICAgICAgICAvPlxuICAgICAgICAgICl9XG4gICAgICAgICAge2lzRW5sYXJnZWQgJiYgIWlzTWluaWZpZWQgPyAoXG4gICAgICAgICAgICA8UGxheWJhY2tDb250cm9sc1xuICAgICAgICAgICAgICBpc0FuaW1hdGFibGU9e2lzQW5pbWF0YWJsZX1cbiAgICAgICAgICAgICAgd2lkdGg9e2FuaW1hdGlvbkNvbnRyb2xXaWR0aH1cbiAgICAgICAgICAgICAgc3BlZWQ9e3NwZWVkfVxuICAgICAgICAgICAgICBhbmltYXRpb25XaW5kb3c9e2FuaW1hdGlvbldpbmRvd31cbiAgICAgICAgICAgICAgdXBkYXRlQW5pbWF0aW9uU3BlZWQ9e3VwZGF0ZUFuaW1hdGlvblNwZWVkfVxuICAgICAgICAgICAgICBzZXRGaWx0ZXJBbmltYXRpb25XaW5kb3c9e3NldEZpbHRlckFuaW1hdGlvbldpbmRvd31cbiAgICAgICAgICAgICAgcGF1c2VBbmltYXRpb249e3RvZ2dsZUFuaW1hdGlvbn1cbiAgICAgICAgICAgICAgcmVzZXRBbmltYXRpb249e3Jlc2V0QW5pbWF0aW9ufVxuICAgICAgICAgICAgICBpc0FuaW1hdGluZz17aXNBbmltYXRpbmd9XG4gICAgICAgICAgICAgIHN0YXJ0QW5pbWF0aW9uPXt0b2dnbGVBbmltYXRpb259XG4gICAgICAgICAgICAvPlxuICAgICAgICAgICkgOiBudWxsfVxuICAgICAgICA8L1N0eWxlZFNsaWRlckNvbnRhaW5lcj5cbiAgICAgIDwvZGl2PlxuICAgICk7XG4gIH07XG5cbiAgcmV0dXJuIFJlYWN0Lm1lbW8oVGltZVJhbmdlU2xpZGVyKTtcbn1cbiJdfQ==